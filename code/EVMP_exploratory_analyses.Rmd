---
title: "2018 Elk Vegetation Management Plan Data Exploration"
author: "Ed Gage"
date: ""
output: 
  html_document: 
    theme: journal
    toc: yes
---


```{r setup, include=FALSE}
library(knitr)
opts_chunk$set(echo = FALSE)
opts_knit$set(root.dir=normalizePath('../')) # this is required if Rmd is nested below the project directory
opts_chunk$set(fig.path = "../output/figures/") # corrected path and added dev. Needed to specify a subdirectory for figs

# see discussion here: https://stackoverflow.com/questions/24585254/working-with-knitr-using-subdirectories

```


**Updated: `r format(Sys.time(), '%Y %B %d')`**

## Introduction

This document provides a basic exploration of EVMP files provided by RMNP in September, 2018.

Analyses aim to characterize basic data structure and identify potential issues such as:

* Inconsistently named/typed factors    
* Missing values
* Data values outside of expected range or showing unusual patterns

In addition, data are cleaned in preparation for further analyses.

```{r,echo=FALSE}
# library(here)
# here()
# install.packages("bindrcpp")
suppressPackageStartupMessages(library(tidyverse))
library(fs)
suppressPackageStartupMessages(library(sf))
# library(raster)
suppressPackageStartupMessages(library(janitor))
suppressPackageStartupMessages(library(readxl))
# library(glue)
suppressPackageStartupMessages(library(mapview))
# library(ggmap)
# library(ggrepel)
suppressPackageStartupMessages(library(viridis))
# library(ggExtra)
library(ggstance)
library(readxl)
library(DT)
# library(kableExtra)
suppressPackageStartupMessages(library(lubridate))
# library(anytime)
# install.packages("fs")
# suppressPackageStartupMessages(library(compare))
suppressPackageStartupMessages(library(skimr)) ## some useful functions
suppressPackageStartupMessages(library(dataMaid))


```

# Data Importation, Exploration, and Wrangling

## Import and overview  {.tabset}  

### List of files provided by RMNP (9/20/2018)  

```{r}
# list of files 
# fs::dir_ls(recursive = TRUE) 

file.listing <- dir_info(recursive = TRUE) %>%
  # filter(type == "file", permissions == "u+r", size > "10KB") %>%
  arrange(desc(size)) %>%
  select(type, path, permissions, size, modification_time)

file.listing %>%
  stringr::str_split(string = path,n = 2,pattern = ".")
  separate(col = path, into = 'fty',sep = ".")

datatable(file.listing)

```


```{r}

# xls_example <- readxl_example("datasets.xls")
# excel_sheets(xls_example)


willow.off <- read_xlsx("data/EVMP_data/provisional_data_20180920/Willow Offtake Data 2009-2018.xlsx")
read_excel(willow.off, sheet = "chickwts")
excel_sheets(willow.off)

asp.bl <- read_excel("data/EVMP_data/provisional_data_20180920/Aspen_Baseline_2013_2018_5_Year_Msmts_Including_Burn_Data.xlsx") 

excel_sheets(asp.bl)

```



### Quality checks

####Missing data####  


# Translation of Past Analyses from SAS 

## Willow Height

Rewrite the SAS program used to analyze willow height data as found in table 9 of Zeigenfuss and Johnson (2015)--Least squares means of average and maximum willow height and percent willow cover on burned sites compared to unburned sites using the macroplot method at EVMP willow monitoring sites in Rocky Mountain National Park, Colorado. 

**Steps:** 

1. Read in data from a file contaning the baseline data from willow macroplots  
2. Calculate canopy area for each plot and assigns the baseline year (2008) to these data 
3. Sort data down to willow and non-willow species groups and calculates mean for the variables "average height" and "maximum ht" for each group.

**See: **  

>willow shrub cover macro table 8.sas  
>willow shrub height table 8.sas  
>willow shrub cover macro table 9.txt    
>willow shrub height table 9.txt  

## Aspen Height  

Rewrite the SAS program used to create figs. 3,4,5, and 7 of Zeigenfuss and Johnson (2015)--Distribution of aspen tree (height greater than 2.5 meters) stem diameters in monitoring sites. 

**Steps:** 
1. Read in data from a file with tallies of live aspen stems by dbh size class  
2. Read in a file with information for each aspen monitoring site  
3. Merge these two files, remove saplings 
4. Reclass trees into groups of small (2-10 cm dbh), medium (10-20 cm dbh) and large (20+ dbh) trees.


**See: **  

>aspen sapling table 4.sas  
>aspen sapling table 5.sas  


## Recreation of Figures from Past Publications  

**Key publications:**  

_Zeigenfuss, L. C., and T. L. Johnson. 2015. Monitoring of Vegetation Response to Elk Population and Habitat Management in Rocky Mountain National Park, 2008â€“14. Report 2015-1216, U.S. Geological Survey, Reston, VA._
[Link](http://pubs.er.usgs.gov/publication/ofr20151216)






